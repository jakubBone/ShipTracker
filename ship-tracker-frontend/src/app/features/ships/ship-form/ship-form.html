<div class="ship-form-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>{{ isEditMode ? 'Edit Ship' : 'Add New Ship' }}</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="submit()" class="ship-form">

        <div class="name-row">
          <mat-form-field appearance="outline" class="name-field">
            <mat-label>Ship Name</mat-label>
            <input matInput formControlName="name" placeholder="Enter name">
            @if (form.controls.name.invalid && form.controls.name.touched) {
              <mat-error>This field is required</mat-error>
            }
          </mat-form-field>

          <button type="button" mat-stroked-button (click)="generateName()">
            <mat-icon>casino</mat-icon>
            Generate Name
          </button>
        </div>

        @if (nameError()) {
          <p class="name-error">{{ nameError() }}</p>
        }

        <mat-form-field appearance="outline">
          <mat-label>Ship Type</mat-label>
          <mat-select formControlName="shipType">
            @for (type of shipTypes; track type) {
              <mat-option [value]="type">{{ type }}</mat-option>
            }
          </mat-select>
          @if (form.controls.shipType.invalid && form.controls.shipType.touched) {
            <mat-error>This field is required</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Launch Date</mat-label>
          <input matInput [matDatepicker]="launchDatePicker" formControlName="launchDate" placeholder="MM/DD/YYYY">
          <mat-datepicker-toggle matIconSuffix [for]="launchDatePicker" />
          <mat-datepicker #launchDatePicker />
          @if (form.controls.launchDate.invalid && form.controls.launchDate.touched) {
            <mat-error>This field is required</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Tonnage (t)</mat-label>
          <input matInput type="number" formControlName="tonnage" placeholder="e.g. 50000">
          @if (form.controls.tonnage.hasError('required') && form.controls.tonnage.touched) {
            <mat-error>This field is required</mat-error>
          }
          @if (form.controls.tonnage.hasError('min') && form.controls.tonnage.touched) {
            <mat-error>Tonnage must be greater than 0</mat-error>
          }
        </mat-form-field>

        <div class="form-actions">
          <button type="button" mat-button (click)="cancel()">Cancel</button>
          <button type="submit" mat-raised-button color="primary" [disabled]="form.invalid || isLoading()">
            {{ isEditMode ? 'Save Changes' : 'Add Ship' }}
          </button>
        </div>

      </form>
    </mat-card-content>
  </mat-card>
</div>
